import{t as h}from"./timer.Dfeo3Vkk.js";import{o as I,d as _,m as T}from"./map.XBgQGlaY.js";function N(s,t){return I(function(n,e){var r=0;n.subscribe(_(e,function(o){return s.call(t,o,r++)&&e.next(o)}))})}const i=class i{static getLViewRegistry(){return window.__ngLViewRegistry__}static getHeaderOffset(){const t=window.__ngLViewIndices__?.HEADER_OFFSET;return typeof t=="number"?t:i.DEFAULT_HEADER_OFFSET}static resolveLViewFromContext(t){if(Array.isArray(t))return t;if(typeof t=="number")return i.getLViewRegistry()?.get(t)??null;if(t&&typeof t=="object"){const n=t;if(Array.isArray(n.lView))return n.lView;if(typeof n.lViewId=="number")return i.getLViewRegistry()?.get(n.lViewId)??null}return null}static unwrapRNode(t){let n=t;for(;Array.isArray(n);)n=n[0];return n}static findNodeIndexInLView(t,n){const e=t[i.LVIEW_TVIEW_INDEX],r=e&&typeof e.bindingStartIndex=="number"?e.bindingStartIndex:t.length,o=Math.min(i.getHeaderOffset(),r);for(let a=o;a<r;a++)if(i.unwrapRNode(t[a])===n)return a;return-1}static getComponentAtNodeIndex(t,n){const r=t[i.LVIEW_TVIEW_INDEX]?.data?.[n];if(!r)return null;const o=r.directiveStart,a=r.componentOffset;if(typeof o=="number"&&typeof a=="number"&&a>-1)return t[o+a]??null;const p=r.directiveEnd;if(typeof o!="number"||typeof p!="number")return null;for(let l=o;l<p;l++){const E=t[l];if(E?.constructor?.Éµcmp)return E}return null}static getParentLView(t){const n=t[i.LVIEW_PARENT_INDEX];if(!Array.isArray(n))return null;if(n[i.LCONTAINER_TYPE_INDEX]===!0){const e=n[i.LVIEW_PARENT_INDEX];return Array.isArray(e)?e:null}return n}static getOwningComponentFromLView(t){let n=t;for(;n&&n[i.LVIEW_TVIEW_INDEX]?.type===i.TVIEW_EMBEDDED_TYPE;)n=i.getParentLView(n);return n?n[i.LVIEW_CONTEXT_INDEX]??null:null}static getComponentByTagName(t){const n=document.querySelector(t);return n?i.getComponentFromElement(n):null}static getFirstRouterOutletChildByComponentSelector(t){const n=document.querySelector(t);if(!n)return null;const e=n.querySelector("router-outlet");if(!e)return null;const r=e.firstElementChild??e.nextElementSibling;return r?i.getComponentFromElement(r):null}static getAllComponentsByTagName(t){const n=document.querySelectorAll(t),e=[];return n.forEach(r=>{const o=i.getComponentFromElement(r);o&&e.push(o)}),e}static getComponentFromElement(t){const n=window.ng?.getComponent;if(typeof n=="function")try{const a=n(t);if(a!=null)return a}catch{}const e=t.__ngContext__;if(console.log("[audako-powertoys] Retrieving Angular component from element:",{element:t,context:e}),e==null)return null;const r=i.resolveLViewFromContext(e);if(!r)return null;const o=i.findNodeIndexInLView(r,t);if(o!==-1){const a=i.getComponentAtNodeIndex(r,o);if(a)return a}return i.getOwningComponentFromLView(r)}static extendMethod(t,n,e){const r=t.__proto__,o=r[n];return r[n]=(...a)=>(e(a),o.bind(t)(a)),t}static extendMethodAsync(t,n,e){const r=t[n+"_original"]??t[n];return t[n+"_original"]=r,t[n]=async(...o)=>(await e(o),r.bind(t)(o)),t}static extendProtoMethodAsync(t,n,e){const r=t.__proto__[n+"_original"]??t.__proto__[n];return t.__proto__[n+"_original"]=r,t.__proto__[n]=async(...o)=>(await e(o),r.bind(t)(o)),t}};i.LVIEW_TVIEW_INDEX=1,i.LVIEW_PARENT_INDEX=3,i.LVIEW_CONTEXT_INDEX=8,i.DEFAULT_HEADER_OFFSET=25,i.TVIEW_EMBEDDED_TYPE=2,i.LCONTAINER_TYPE_INDEX=1;let d=i;var c=(s=>(s.Dashboard="Dashboard",s.Configuration="Configuration",s.Administration="Administration",s.Maintenance="Maintenance",s))(c||{});const M={Dashboard:"adk adk-dashboard",Administration:"adk adk-staff-assignment"},u=class u{static openApp(t,n,e,r,o){const a=u.buildAppUrl(t,n,e,r,o);window.location.href=a}static buildAppUrl(t,n,e,r,o){let a=null;switch(t){case c.Dashboard:a=`/${n}/application/${e??""}`,r&&(a+=`/${r??""}`);break;case c.Configuration:a=`/${n}/config/${e??""}`,r&&o&&(a+=`/${r}/${o}`);break;case c.Administration:a=`administration/${n}`;break}return a}static getTenantIdFromUrl(t){if(!t||t.length===0)return null;const n=t.split("/")[1];return n.length===24?n:null}static getCurrentApp(){return u.getAppFromUrl(window.location.pathname)}static getAppFromUrl(t){if(!t||t.length===0)return null;const n=t.split("/")[2];return u.appRouteMapping[n]?u.appRouteMapping[n]:null}static getAppUrl(t){let n=null;return Object.keys(u.appRouteMapping).forEach(e=>{u.appRouteMapping[e]===t&&(n=e)}),n}static getGroupIdFromUrl(t){if(!u.getAppFromUrl(t))return null;const e=t.match(/(.{24})\/(application|config)\/(.{24})/);return e?e[3]:null}static subscribeToUrl(){let t=null;return h(0,50).pipe(N(()=>t!==window.location.pathname),T(()=>(t=window.location.pathname,t)))}static isActiveApp(t){const n=window.location.pathname,e={[c.Administration]:"administration",[c.Configuration]:"config",[c.Dashboard]:"application",[c.Maintenance]:"maintenance"};return n.includes(e[t])}static isInEntityConfiguration(){const t=window.location.pathname;return u.isActiveApp(c.Configuration)&&t.includes("detail")}static getEntityConfigurationDetails(){const n=window.location.pathname.match(/(.{24})\/config\/(.{24})\/detail\/(.{3,24})\/([A-z]+)/);return n?{tenantId:n[1],groupId:n[2],entityId:n[3],entityType:n[4]}:null}static isInEntityList(){return window.location.pathname.includes("list")}static getEntityListDetails(){const n=window.location.pathname.match(/(.{24})\/config\/(.{24})\/list\/([A-z]+)/);return n?{tenantId:n[1],groupId:n[2],entityType:n[3]}:null}};u.appRouteMapping={config:c.Configuration,application:c.Dashboard};let f=u;const g="audako-powertoys-extension",m="audako-powertoys-main",w="audako-powertoys:event",y="audako-powertoys:event:ack",L="entity.updated",V="entity.created",D=[L,V],b=new Set(D);function A(s){return!!s&&typeof s=="object"}function O(s){return typeof s=="string"&&b.has(s)}function S(s){return A(s)&&s.source===g&&s.type===w}function W(s){return A(s)&&s.source===m&&s.type===y}function F(s,t,n){const e={source:g,type:w,payload:{name:s,detail:t}};n&&(e.requestId=n),window.postMessage(e,"*")}function x(s,t,n=!0){const e={source:m,type:y,requestId:t,payload:{event:s,ok:n}};window.postMessage(e,"*")}export{c as A,d as C,V as E,f as U,M as a,S as b,O as c,F as d,x as e,N as f,L as g,W as i};
